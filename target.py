# curl 'https://redsky.target.com/redsky_aggregations/v1/web/plp_search_v2?key=9f36aeafbe60771e321a7cc95a78140772ab3e96&category=yz7nt&channel=WEB&count=24&default_purchasability_filter=true&include_sponsored=true&offset=24&page=%2Fc%2Fyz7nt&platform=mobile&pricing_store_id=83&store_ids=83%2C2190%2C770&useragent=Mozilla%2F5.0+%28Linux%3B+Android+6.0%3B+Nexus+5+Build%2FMRA58N%29+AppleWebKit%2F537.36+%28KHTML%2C+like+Gecko%29+Chrome%2F110.0.0.0+Mobile+Safari%2F537.36&visitor_id=0186612F72AD020192513D4B25087EDC&zip=79364' \
#   -H 'authority: redsky.target.com' \
#   -H 'accept: application/json' \
#   -H 'accept-language: en-US,en;q=0.9' \
#   -H 'cookie: TealeafAkaSid=mh7cYCXaQAo5_tQqQAzb89Hydi38el3Q; visitorId=0186612F72AD020192513D4B25087EDC; sapphire=1; UserLocation=79364|33.440|-101.650|TX|US; fiatsCookie=DSI_83|DSN_Lubbock%20University%20Ave|DSZ_79423; ci_pixmgr=other; _gcl_au=1.1.538189206.1676667753; _ga=GA1.2.1619494967.1676668624; __gads=ID=745146e152674252:T=1676750262:S=ALNI_MazrU5IZnHEVSWlbvC_m-K10KC25g; __gpi=UID=0000094a135050e5:T=1676750262:RT=1676750262:S=ALNI_MZWX-O5SR8Z59c8VgHNHpd6TJ2geQ; egsSessionId=56e634dc-c622-4dee-b268-c9d03c125104; accessToken=eyJraWQiOiJlYXMyIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiIwMWU1NjFhZi1hNThjLTRkYWItODdjMS04YTkwMDIxMGZjY2YiLCJpc3MiOiJNSTYiLCJleHAiOjE2NzcxMTk4NjksImlhdCI6MTY3NzAzMzQ2OSwianRpIjoiVEdULjYxOWM5YmI4OTAwNDRkODc5Y2QyYjU3ZjA2NjUyZThmLWwiLCJza3kiOiJlYXMyIiwic3V0IjoiRyIsImRpZCI6ImM0Njg3NzIwMDY4ZmVmODBiNjZjZDk0NDIzZTEzZTA4NTk2N2JkYzUxOTI1NmQ2OGM4MTk3OGRhNzUzNDcwMTMiLCJzY28iOiJlY29tLm5vbmUsb3BlbmlkIiwiY2xpIjoiZWNvbS13ZWItMS4wLjAiLCJhc2wiOiJMIn0.eh0EGcdP4ZNFyK9ifJLJ6KSRz_FVKfeil5HUK99vyjtT4Pt2BqfVAN2ZC14L3U0NhWuSAkLRzaaS7T8hf8-rOV0KvCQOBMkHTF2aFkyuG7VtTOcYmBMA6nhqFwGoKOg2yVNGwkqtelR77vVgQjLtuauzg3EXp1Mvo-qyZBDsmP160I187A-49PM4jbJVn3m_F2P1pswPy1I_CPoeiarG99HCuTduJajcsDglzoolP_csMSlmDfA6YQzKmMEJKqNcHbwDOuWe_XInXE5nFEEYcxSMQ7vI_zweZYNBYprUkLgn4rKh66c7RtIrKUSQZRqKinIeFYljhuD0i0eXg1AKww; idToken=eyJhbGciOiJub25lIn0.eyJzdWIiOiIwMWU1NjFhZi1hNThjLTRkYWItODdjMS04YTkwMDIxMGZjY2YiLCJpc3MiOiJNSTYiLCJleHAiOjE2NzcxMTk4NjksImlhdCI6MTY3NzAzMzQ2OSwiYXNzIjoiTCIsInN1dCI6IkciLCJjbGkiOiJlY29tLXdlYi0xLjAuMCIsInBybyI6eyJmbiI6bnVsbCwiZW0iOm51bGwsInBoIjpmYWxzZSwibGVkIjpudWxsLCJsdHkiOmZhbHNlfX0.; refreshToken=5lOj66OfC4Hl8-O_IsNIl6cGCxX_X2d1ZUCxY-7TX9n4EpEJobRegsACr3xiEXHYRVDRHMUmJmEkNuJ4xApukw; _mitata=NDNlNTdkM2FjNWI0ZTQ0NDc0NGYwYjFhN2Y0MzNjMDY1MmI0ODg2YmE1YTQ0YzMzNGY1YTNkNTY4OGVmYThlMQ==_/@#/1677033534_/@#/cH58xGTNmpo2Xj37_/@#/NmY5NmYxYjYxNTRmM2E0ODNjOTU5Y2ExOWQ1MTgyN2I4MGVhYTUzYzkxZTBlMzQyZGM1MThmNDVkYTUwMjQ2OA==_/@#/000; ffsession={%22sessionHash%22:%229316a55e22a721676667747678%22%2C%22prevPageName%22:%22movies%2C%20music%20&%20books:%20music:%20vinyl%20records%22%2C%22prevPageType%22:%22level%203%22%2C%22prevPageUrl%22:%22https://www.target.com/c/vinyl-records-music-movies-books/-/N-yz7nt%22%2C%22prevSearchTerm%22:%22non-search%22%2C%22sessionHit%22:35}; _uetsid=e8bcb550b25911ed8ed6a76c3da9e091; _uetvid=65a1f630af0611edafaeeb821e37aa76' \
#   -H 'origin: https://www.target.com' \
#   -H 'referer: https://www.target.com/c/vinyl-records-music-movies-books/-/N-yz7nt' \
#   -H 'sec-ch-ua: "Chromium";v="110", "Not A(Brand";v="24", "Google Chrome";v="110"' \
#   -H 'sec-ch-ua-mobile: ?1' \
#   -H 'sec-ch-ua-platform: "Android"' \
#   -H 'sec-fetch-dest: empty' \
#   -H 'sec-fetch-mode: cors' \
#   -H 'sec-fetch-site: same-site' \
#   -H 'user-agent: Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Mobile Safari/537.36' \
#   --compressed

import time
import requests
import json

vinylArr = []

cookies = {
    'TealeafAkaSid': 'mh7cYCXaQAo5_tQqQAzb89Hydi38el3Q',
    'visitorId': '0186612F72AD020192513D4B25087EDC',
    'sapphire': '1',
    'UserLocation': '79364|33.440|-101.650|TX|US',
    'fiatsCookie': 'DSI_83|DSN_Lubbock%20University%20Ave|DSZ_79423',
    'ci_pixmgr': 'other',
    '_gcl_au': '1.1.538189206.1676667753',
    '_ga': 'GA1.2.1619494967.1676668624',
    '__gads': 'ID=745146e152674252:T=1676750262:S=ALNI_MazrU5IZnHEVSWlbvC_m-K10KC25g',
    '__gpi': 'UID=0000094a135050e5:T=1676750262:RT=1676750262:S=ALNI_MZWX-O5SR8Z59c8VgHNHpd6TJ2geQ',
    'egsSessionId': '56e634dc-c622-4dee-b268-c9d03c125104',
    'accessToken': 'eyJraWQiOiJlYXMyIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiIwMWU1NjFhZi1hNThjLTRkYWItODdjMS04YTkwMDIxMGZjY2YiLCJpc3MiOiJNSTYiLCJleHAiOjE2NzcxMTk4NjksImlhdCI6MTY3NzAzMzQ2OSwianRpIjoiVEdULjYxOWM5YmI4OTAwNDRkODc5Y2QyYjU3ZjA2NjUyZThmLWwiLCJza3kiOiJlYXMyIiwic3V0IjoiRyIsImRpZCI6ImM0Njg3NzIwMDY4ZmVmODBiNjZjZDk0NDIzZTEzZTA4NTk2N2JkYzUxOTI1NmQ2OGM4MTk3OGRhNzUzNDcwMTMiLCJzY28iOiJlY29tLm5vbmUsb3BlbmlkIiwiY2xpIjoiZWNvbS13ZWItMS4wLjAiLCJhc2wiOiJMIn0.eh0EGcdP4ZNFyK9ifJLJ6KSRz_FVKfeil5HUK99vyjtT4Pt2BqfVAN2ZC14L3U0NhWuSAkLRzaaS7T8hf8-rOV0KvCQOBMkHTF2aFkyuG7VtTOcYmBMA6nhqFwGoKOg2yVNGwkqtelR77vVgQjLtuauzg3EXp1Mvo-qyZBDsmP160I187A-49PM4jbJVn3m_F2P1pswPy1I_CPoeiarG99HCuTduJajcsDglzoolP_csMSlmDfA6YQzKmMEJKqNcHbwDOuWe_XInXE5nFEEYcxSMQ7vI_zweZYNBYprUkLgn4rKh66c7RtIrKUSQZRqKinIeFYljhuD0i0eXg1AKww',
    'idToken': 'eyJhbGciOiJub25lIn0.eyJzdWIiOiIwMWU1NjFhZi1hNThjLTRkYWItODdjMS04YTkwMDIxMGZjY2YiLCJpc3MiOiJNSTYiLCJleHAiOjE2NzcxMTk4NjksImlhdCI6MTY3NzAzMzQ2OSwiYXNzIjoiTCIsInN1dCI6IkciLCJjbGkiOiJlY29tLXdlYi0xLjAuMCIsInBybyI6eyJmbiI6bnVsbCwiZW0iOm51bGwsInBoIjpmYWxzZSwibGVkIjpudWxsLCJsdHkiOmZhbHNlfX0.',
    'refreshToken': '5lOj66OfC4Hl8-O_IsNIl6cGCxX_X2d1ZUCxY-7TX9n4EpEJobRegsACr3xiEXHYRVDRHMUmJmEkNuJ4xApukw',
    '_mitata': 'NDNlNTdkM2FjNWI0ZTQ0NDc0NGYwYjFhN2Y0MzNjMDY1MmI0ODg2YmE1YTQ0YzMzNGY1YTNkNTY4OGVmYThlMQ==_/@#/1677033534_/@#/cH58xGTNmpo2Xj37_/@#/NmY5NmYxYjYxNTRmM2E0ODNjOTU5Y2ExOWQ1MTgyN2I4MGVhYTUzYzkxZTBlMzQyZGM1MThmNDVkYTUwMjQ2OA==_/@#/000',
    'ffsession': '{%22sessionHash%22:%229316a55e22a721676667747678%22%2C%22prevPageName%22:%22movies%2C%20music%20&%20books:%20music:%20vinyl%20records%22%2C%22prevPageType%22:%22level%203%22%2C%22prevPageUrl%22:%22https://www.target.com/c/vinyl-records-music-movies-books/-/N-yz7nt%22%2C%22prevSearchTerm%22:%22non-search%22%2C%22sessionHit%22:35}',
    '_uetsid': 'e8bcb550b25911ed8ed6a76c3da9e091',
    '_uetvid': '65a1f630af0611edafaeeb821e37aa76',
}

headers = {
    'authority': 'redsky.target.com',
    'accept': 'application/json',
    'accept-language': 'en-US,en;q=0.9',
    # 'cookie': 'TealeafAkaSid=mh7cYCXaQAo5_tQqQAzb89Hydi38el3Q; visitorId=0186612F72AD020192513D4B25087EDC; sapphire=1; UserLocation=79364|33.440|-101.650|TX|US; fiatsCookie=DSI_83|DSN_Lubbock%20University%20Ave|DSZ_79423; ci_pixmgr=other; _gcl_au=1.1.538189206.1676667753; _ga=GA1.2.1619494967.1676668624; __gads=ID=745146e152674252:T=1676750262:S=ALNI_MazrU5IZnHEVSWlbvC_m-K10KC25g; __gpi=UID=0000094a135050e5:T=1676750262:RT=1676750262:S=ALNI_MZWX-O5SR8Z59c8VgHNHpd6TJ2geQ; egsSessionId=56e634dc-c622-4dee-b268-c9d03c125104; accessToken=eyJraWQiOiJlYXMyIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiIwMWU1NjFhZi1hNThjLTRkYWItODdjMS04YTkwMDIxMGZjY2YiLCJpc3MiOiJNSTYiLCJleHAiOjE2NzcxMTk4NjksImlhdCI6MTY3NzAzMzQ2OSwianRpIjoiVEdULjYxOWM5YmI4OTAwNDRkODc5Y2QyYjU3ZjA2NjUyZThmLWwiLCJza3kiOiJlYXMyIiwic3V0IjoiRyIsImRpZCI6ImM0Njg3NzIwMDY4ZmVmODBiNjZjZDk0NDIzZTEzZTA4NTk2N2JkYzUxOTI1NmQ2OGM4MTk3OGRhNzUzNDcwMTMiLCJzY28iOiJlY29tLm5vbmUsb3BlbmlkIiwiY2xpIjoiZWNvbS13ZWItMS4wLjAiLCJhc2wiOiJMIn0.eh0EGcdP4ZNFyK9ifJLJ6KSRz_FVKfeil5HUK99vyjtT4Pt2BqfVAN2ZC14L3U0NhWuSAkLRzaaS7T8hf8-rOV0KvCQOBMkHTF2aFkyuG7VtTOcYmBMA6nhqFwGoKOg2yVNGwkqtelR77vVgQjLtuauzg3EXp1Mvo-qyZBDsmP160I187A-49PM4jbJVn3m_F2P1pswPy1I_CPoeiarG99HCuTduJajcsDglzoolP_csMSlmDfA6YQzKmMEJKqNcHbwDOuWe_XInXE5nFEEYcxSMQ7vI_zweZYNBYprUkLgn4rKh66c7RtIrKUSQZRqKinIeFYljhuD0i0eXg1AKww; idToken=eyJhbGciOiJub25lIn0.eyJzdWIiOiIwMWU1NjFhZi1hNThjLTRkYWItODdjMS04YTkwMDIxMGZjY2YiLCJpc3MiOiJNSTYiLCJleHAiOjE2NzcxMTk4NjksImlhdCI6MTY3NzAzMzQ2OSwiYXNzIjoiTCIsInN1dCI6IkciLCJjbGkiOiJlY29tLXdlYi0xLjAuMCIsInBybyI6eyJmbiI6bnVsbCwiZW0iOm51bGwsInBoIjpmYWxzZSwibGVkIjpudWxsLCJsdHkiOmZhbHNlfX0.; refreshToken=5lOj66OfC4Hl8-O_IsNIl6cGCxX_X2d1ZUCxY-7TX9n4EpEJobRegsACr3xiEXHYRVDRHMUmJmEkNuJ4xApukw; _mitata=NDNlNTdkM2FjNWI0ZTQ0NDc0NGYwYjFhN2Y0MzNjMDY1MmI0ODg2YmE1YTQ0YzMzNGY1YTNkNTY4OGVmYThlMQ==_/@#/1677033534_/@#/cH58xGTNmpo2Xj37_/@#/NmY5NmYxYjYxNTRmM2E0ODNjOTU5Y2ExOWQ1MTgyN2I4MGVhYTUzYzkxZTBlMzQyZGM1MThmNDVkYTUwMjQ2OA==_/@#/000; ffsession={%22sessionHash%22:%229316a55e22a721676667747678%22%2C%22prevPageName%22:%22movies%2C%20music%20&%20books:%20music:%20vinyl%20records%22%2C%22prevPageType%22:%22level%203%22%2C%22prevPageUrl%22:%22https://www.target.com/c/vinyl-records-music-movies-books/-/N-yz7nt%22%2C%22prevSearchTerm%22:%22non-search%22%2C%22sessionHit%22:35}; _uetsid=e8bcb550b25911ed8ed6a76c3da9e091; _uetvid=65a1f630af0611edafaeeb821e37aa76',
    'origin': 'https://www.target.com',
    'referer': 'https://www.target.com/c/vinyl-records-music-movies-books/-/N-yz7nt',
    'sec-ch-ua': '"Chromium";v="110", "Not A(Brand";v="24", "Google Chrome";v="110"',
    'sec-ch-ua-mobile': '?1',
    'sec-ch-ua-platform': '"Android"',
    'sec-fetch-dest': 'empty',
    'sec-fetch-mode': 'cors',
    'sec-fetch-site': 'same-site',
    'user-agent': 'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Mobile Safari/537.36',
}

def requestTarget(offset=0):
  response = requests.get(
    'https://redsky.target.com/redsky_aggregations/v1/web/plp_search_v2',
    params = {
    'key': '9f36aeafbe60771e321a7cc95a78140772ab3e96',
    'category': 'yz7nt',
    'channel': 'WEB',
    'count': '24',
    'default_purchasability_filter': 'true',
    'include_sponsored': 'true',
    'offset': f'{offset}',
    'page': '/c/yz7nt',
    'platform': 'mobile',
    'pricing_store_id': '83',
    'store_ids': '83,2190,770',
    'useragent': 'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Mobile Safari/537.36',
    'visitor_id': '0186612F72AD020192513D4B25087EDC',
    'zip': '79364',
    },
    cookies=cookies,
    headers=headers,
  )
  formatAsJson(response, offset)

def formatAsJson(response, offset):
  json_formatted_str = json.loads(response.text)

  turnJSONintoReadable(json_formatted_str, offset)


def turnJSONintoReadable(json_formatted_str, offset):
  products = json_formatted_str['data']['search']['products']
  print(products)
  for product in products:
    vinylArr.append(product['item']['product_description']['title'])
  offset+=24
  time.sleep(.1)
  try:
    requestTarget(offset)
  except:
    print(vinylArr)

requestTarget()





